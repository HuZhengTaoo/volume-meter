(this["webpackJsonpvolume-meter"]=this["webpackJsonpvolume-meter"]||[]).push([[0],[,,,,,,,,,,,function(e,t,r){},function(e,t,r){},,function(e,t,r){},,function(e,t,r){},function(e,t,r){"use strict";r.r(t);var n=r(0),c=r.n(n),o=r(5),a=r.n(o),u=(r(11),r(2)),s=r.p+"static/media/logo.6ce24c58.svg",i=(r(12),r(4)),l=r.n(i),d=r(6);var m=function(e){var t=c.a.useState(0),r=Object(u.a)(t,2),n=r[0],o=r[1],a=c.a.useRef({}),s=c.a.useCallback((function(e){a.current.audioContext&&e.data.volume&&o(Math.round(200*e.data.volume))}),[]),i=c.a.useCallback((function(){if(a.current.node)try{a.current.node.disconnect()}catch(e){}if(a.current.source)try{a.current.source.disconnect()}catch(e){}a.current.node=null,a.current.source=null,a.current.audioContext=null,o(0)}),[]),m=c.a.useCallback(function(){var e=Object(d.a)(l.a.mark((function e(t){return l.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return a.current.audioContext&&i(),e.prev=1,a.current.audioContext=new AudioContext,e.next=5,a.current.audioContext.audioWorklet.addModule("./worklet/vumeter.js");case 5:if(a.current.audioContext){e.next=7;break}return e.abrupt("return");case 7:a.current.source=a.current.audioContext.createMediaStreamSource(t),a.current.node=new AudioWorkletNode(a.current.audioContext,"vumeter"),a.current.node.port.onmessage=s,a.current.source.connect(a.current.node).connect(a.current.audioContext.destination),e.next=16;break;case 13:e.prev=13,e.t0=e.catch(1),i();case 16:case"end":return e.stop()}}),e,null,[[1,13]])})));return function(t){return e.apply(this,arguments)}}(),[i,s]);return c.a.useEffect((function(){return o(0),e?(m(e),function(){i(e)}):function(){}}),[e,m,i]),n},f=(r(14),r(1)),x=function(e){var t=e.volume,r=e.max,n=void 0===r?10:r,o=e.style,a=void 0===o?{}:o,u=c.a.useMemo((function(){for(var e=[],t=100/(2*n),r=0;r<n;r+=1)e.push(Object(f.jsx)("div",{className:"volumeMeterDivider",style:{left:"".concat((2*r+1)*t,"%"),width:"".concat(t,"%")}},r));return e}),[n]);return Object(f.jsxs)("div",{className:"volumeMeter",style:a,children:[Object(f.jsx)("div",{className:"volumeMeterBg"}),Object(f.jsx)("div",{className:"volumeMeterInner",style:{transform:"scaleX(".concat(Math.ceil(t*n/100)/n,")")}}),u]})};x.defaultProps={volume:null,max:0,style:null};var v=c.a.memo(x,(function(e,t){return e.volume===t.volume&&e.max===t.max&&e.style===t.style})),p=function(e){var t=e.stream,r=e.max,n=e.style,c=m(t);return Object(f.jsx)(v,{volume:c,max:r,style:n})};p.defaultProps={stream:null,max:0,style:null};var j=c.a.memo(p,(function(e,t){return e.stream===t.stream&&e.max===t.max&&e.style===t.style}));var b=function(e){var t=c.a.useState(0),r=Object(u.a)(t,2),n=r[0],o=r[1],a=c.a.useRef({}),s=c.a.useCallback((function(e){if(a.current.scriptProcessor){for(var t=e.inputBuffer.getChannelData(0),r=0,n=0;n<t.length;n+=1)r+=t[n]*t[n];o(Math.round(100*Math.sqrt(r/t.length)))}}),[]),i=c.a.useCallback((function(e){if(a.current.gainNode)try{a.current.gainNode.disconnect()}catch(t){}if(a.current.scriptProcessor)try{a.current.scriptProcessor.disconnect()}catch(t){}if(a.current.mediaStreamSource)try{a.current.mediaStreamSource.disconnect()}catch(t){}a.current.gainNode=null,a.current.scriptProcessor=null,a.current.mediaStreamSource=null,a.current.audioContext=null,o(0)}),[]),l=c.a.useCallback((function(e){try{a.current.audioContext=new AudioContext,a.current.mediaStreamSource=a.current.audioContext.createMediaStreamSource(e),a.current.scriptProcessor=a.current.audioContext.createScriptProcessor(2048,1,1),a.current.scriptProcessor.onaudioprocess=s,a.current.scriptProcessor.connect(a.current.audioContext.destination),a.current.mediaStreamSource.connect(a.current.scriptProcessor)}catch(t){i()}}),[i,s]);return c.a.useEffect((function(){return o(0),e?(l(e),function(){i(e)}):function(){}}),[e,l,i]),n},y=function(e){var t=e.stream,r=e.max,n=e.style,c=b(t);return Object(f.jsx)(v,{volume:c,max:r,style:n})};y.defaultProps={stream:null,max:0,style:null};var h=c.a.memo(y,(function(e,t){return e.stream===t.stream&&e.max===t.max&&e.style===t.style})),C=(r(16),function(e){var t=e.stream,r=e.max,n=void 0===r?10:r,c=e.style,o=void 0===c?{}:c,a=e.type;return"AudioWorkletNode"===(void 0===a?"AudioWorkletNode":a)?Object(f.jsx)(j,{stream:t,max:n,style:o}):Object(f.jsx)(h,{stream:t,max:n,style:o})});C.defaultProps={type:"AudioWorkletNode",stream:null,max:0,style:null};var O=c.a.memo(C,(function(e,t){return e.type===t.type&&e.stream===t.stream&&e.max===t.max&&e.style===t.style}));var S=function(){var e=c.a.useState(""),t=Object(u.a)(e,2),r=t[0],n=t[1],o=c.a.useState(null),a=Object(u.a)(o,2),i=a[0],l=a[1];return c.a.useEffect((function(){navigator.mediaDevices.getUserMedia({video:!1,audio:!0}).then((function(e){l(e)}))}),[]),Object(f.jsx)("div",{className:"App",children:Object(f.jsxs)("header",{className:"App-header",children:[Object(f.jsx)("img",{src:s,className:"App-logo",alt:"logo"}),Object(f.jsxs)("div",{className:"buttons",children:[Object(f.jsx)("button",{className:"button",onClick:function(){return n("AudioWorkletNode")},children:"AudioWorkletNodeVolumeMeter"}),Object(f.jsx)("br",{}),Object(f.jsx)("button",{className:"button",onClick:function(){return n("ScriptProcessorNode")},children:"ScriptProcessorNodeVolumeMeter"})]}),Object(f.jsxs)("div",{className:"type",children:["current type: ",r]}),r&&Object(f.jsx)(O,{type:r,stream:i,max:20,style:{width:"160px",backgroundColor:"#282c34"}})]})})},g=function(e){e&&e instanceof Function&&r.e(3).then(r.bind(null,18)).then((function(t){var r=t.getCLS,n=t.getFID,c=t.getFCP,o=t.getLCP,a=t.getTTFB;r(e),n(e),c(e),o(e),a(e)}))};a.a.render(Object(f.jsx)(c.a.StrictMode,{children:Object(f.jsx)(S,{})}),document.getElementById("root")),g()}],[[17,1,2]]]);
//# sourceMappingURL=main.f3636435.chunk.js.map